---
title: "Scenario Plots"
author: "Greg Macfarlane"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
```{r setup}
library(knitr)
opts_chunk$set(fig.width=8, fig.height=6)
```

I have been tasked with coming up with a convenient method for digesting the 
results of a SWIM model run. I think the best thing to do is to create a series
of helper functions that will create plots or calculate metrics on tables pulled
directly from the database. I have wrapped these functions in an Rpackage that
I am calling `swimr`. 


```{r load_swimr}
library(swimr)
```

The package relies on `dplyr`, `ggplot2`, and other modern R packages. These
should be installed by default, but I use them for lots of things so I'll load
them here.

```{r load_libraries, message=FALSE, warning=FALSE}
library(dplyr)
library(tidyr)
library(ggplot2)
```

One advantage of the `dplyr` package is that it can work on the SQLite database
directly. For more information, see the `dplyr`
[vignette](http://cran.r-project.org/web/packages/dplyr/vignettes/databases.html).

```{r point_to_db}
db_path <- "~/Documents/projects/swim/midjuly_swim.db"
db <- src_sqlite(db_path)
db
```

# Single Scenario

## Population and Employment

The `plot_sevar()` function makes a plot like Alex's, comparing population and 
employment in a county. It draws control tables from a `data_frame` included
with the package. You can also compare multiple counties.


```{r plot_sevar}
plot_sevar(db, color_var = "COUNTY", 
           color_levels = c("Multnomah", "Washington", "Clackamas"))
```

## Floorspace

```{r floorspace}
plot_floorspace(db, facet_var = "MPO", 
                facet_levels = c("Metro", "Corvallis", "EugeneSpringfield"))

```

## Traffic

```{r validation}
#plot_validation(db)
```

## Trips
```{r trips}
plot_trips(db, "MPO", share = TRUE)
plot_trips(db, "MPO", share = FALSE)
```



## VMT/VHT
```{r vmt}
plot_vmt(db)
```

```{r vht}
plot_vht(db)
```

## Congestion
```{r congested}
plot_pct_cong(db)
```


